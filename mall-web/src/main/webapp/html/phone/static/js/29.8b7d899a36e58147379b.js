webpackJsonp([29],{"0Kd3":function(t,e,o){e=t.exports=o("I71c")(!1),e.push([t.i,".comment-main[data-v-55e6ee8f]{width:100%;padding-bottom:.89333333rem}.comment-main .comment-goods[data-v-55e6ee8f]{background:#fff;padding:.13333333rem .26666667rem;margin-bottom:.13333333rem}.comment-main .comment-goods .goods-img[data-v-55e6ee8f]{float:left;width:1.76rem;height:1.76rem;background-size:cover;background-position:50%}.comment-main .comment-goods .goods-txt[data-v-55e6ee8f]{width:72%;float:right}.comment-main .comment-goods .goods-txt>p[data-v-55e6ee8f]:last-child{margin-top:.32rem}.comment-main .comment-content[data-v-55e6ee8f]{font-size:0;background:#fff;padding:.26666667rem 0 0;width:100%}.comment-main .comment-content .comment-textarea[data-v-55e6ee8f]{width:92%;margin:0 auto;display:block;height:4.13333333rem;border:1px solid #ededed;background:0;padding:.06666667rem}.comment-main .comment-content .comment-photo[data-v-55e6ee8f]{width:100%;text-align:justify;padding:.26666667rem}.comment-main .comment-content .comment-photo .comment-img[data-v-55e6ee8f],.comment-main .comment-content .comment-photo .comment-upload[data-v-55e6ee8f]{float:left;position:relative;width:1.76666667rem;height:1.76666667rem;background-size:cover;background-position:50%;margin-top:.26666667rem;margin-right:.2rem}.comment-main .comment-content .comment-photo .comment-img input[data-v-55e6ee8f],.comment-main .comment-content .comment-photo .comment-upload input[data-v-55e6ee8f]{position:absolute;width:100%;height:100%;display:block;top:0;left:0;opacity:0}.comment-main .comment-content .comment-photo .comment-img[data-v-55e6ee8f]{position:relative;z-index:1}.comment-main .comment-content .comment-photo .comment-img img[data-v-55e6ee8f]{width:100%;height:100%}.comment-main .comment-content .comment-photo .comment-img i[data-v-55e6ee8f]{z-index:2;width:.4rem;height:.4rem;text-align:center;line-height:.4rem;background:rgba(0,0,0,.6);color:#e0e0e8;font-size:.24rem;border-radius:100%;position:absolute;top:-8%;right:-8%}.comment-main .comment-content .comment-photo .border-img[data-v-55e6ee8f]{border:1px solid #ededed;width:26%;height:1.86666667rem}.comment-main .comment-content .comment-txt[data-v-55e6ee8f]{width:100%;padding:0 .26666667rem}.comment-main .comment-main-footer[data-v-55e6ee8f]{width:100%;padding:0 .3rem;background:#fff;font-size:0}.comment-main .comment-main-footer .comment-button[data-v-55e6ee8f]{text-align:center;width:33%;display:inline-block;padding:.32rem 0;color:#888}.comment-main .comment-main-footer .comment-button i[data-v-55e6ee8f]{font-size:.45333333rem}.comment-main .comment-main-footer .comment-button>i[data-v-55e6ee8f]:first-child{display:inline-block}.comment-main .comment-main-footer .comment-button>i[data-v-55e6ee8f]:last-child{display:none}.comment-main .comment-main-footer .selected[data-v-55e6ee8f]{color:#e4393c}.comment-main .comment-main-footer .selected>i[data-v-55e6ee8f]:first-child{display:none}.comment-main .comment-main-footer .selected>i[data-v-55e6ee8f]:last-child{display:inline-block}.comment-footer1[data-v-55e6ee8f]{width:100%}.comment-footer1 .shop-max-button[data-v-55e6ee8f]{height:.89333333rem;border-radius:0}.icon-guanbi[data-v-55e6ee8f]{z-index:2}",""])},DPYN:function(t,e,o){"use strict";function i(t){o("cpGb")}Object.defineProperty(e,"__esModule",{value:!0});var a=o("l4l+"),n={name:"comment",data:function(){return{imageArr:[],background:null,busId:this.$route.params.busId||sessionStorage.getItem("busId"),orderDetailId:this.$route.params.orderDetailId,imgUrl:"",productObj:{},content:"",feel:1}},components:{defaultImg:defaultImg,imgUpload:a.a},mounted:function(){this.loadDatas(),this.commonFn.setTitle("评论"),this.$store.commit("show_footer",!1)},beforeDestroy:function(){this.$store.commit("show_footer",!0)},methods:{comment_selected:function(t){this.feel=t},removeImages:function(t){this.imageArr.splice(t,1)},returnUrl:function(t){var e=this;null!=e.imageArr&&null!=t?t.forEach(function(t,o){e.$set(e.imageArr,e.imageArr.length,t)}):null!=t&&(e.imageArr=t)},loadDatas:function(){var t=this,e={busId:t.busId,url:location.href,orderDetailId:this.orderDetailId,browerType:t.$store.state.browerType};t.ajaxRequest({url:h5App.activeAPI.to_comment_product_post,data:e,success:function(e){var o=e.data;t.imgUrl=e.imgUrl,t.productObj=o}})},blurValidate:function(){var t=this.commonFn.isNull,e=this.content,o=this.$parent.$refs.bubble.show_tips;return t(e)?(o(Language.comment_content_null_msg),!1):!(e.length>240)||(o(Language.comment_content_length_msg),!1)},submitComment:function(){var t=this,e=this.productObj;if(!this.blurValidate())return!1;var o={busId:t.busId,url:location.href,browerType:t.$store.state.browerType,orderId:e.orderId,orderDetailId:this.orderDetailId,productId:e.productId,content:this.content,feel:this.feel};null!=this.imageArr&&this.imageArr.length>0&&(o.imageUrls=this.imageArr.toString()),t.ajaxRequest({url:h5App.activeAPI.save_comment_post,data:o,loading:!0,success:function(e){var o=t.busId,i=e.data;t.$router.push("/comment/success/"+o+"/"+i),t.$store.commit("is_show_loading",!1)}})},toReturnProductDetail:function(t,e,o){var i=productObj.orderType||0,a=productObj.activityId||0;this.$router.push("/goods/details/"+e+"/"+o+"/"+i+"/"+t+"/"+a)}}},m=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"shop-wrapper ",attrs:{id:"app"}},[o("div",{staticClass:"comment-main"},[null!=t.productObj?o("div",{staticClass:"comment-goods clearfix",on:{click:function(e){t.toReturnProductDetail(t.productObj.productId,t.productObj.shopId,t.productObj.busId)}}},[o("div",{staticClass:"goods-img"},[o("default-img",{attrs:{background:t.imgUrl+t.productObj.productImageUrl,isHeadPortrait:0,size:"0.8rem"}})],1),t._v(" "),o("div",{staticClass:"goods-txt"},[o("p",{staticClass:"fs40"},[t._v(t._s(t.productObj.productName))]),t._v(" "),o("p",{staticClass:"fs36 shopGray"},[null!=t.productObj.productSpecifica?o("em",[t._v(t._s(t.productObj.productSpecifica)+"/")]):t._e(),t._v(t._s(t.productObj.productNum)+"件\r\n                ")])])]):t._e(),t._v(" "),o("div",{staticClass:"comment-content"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"comment-textarea fs46",attrs:{placeholder:"请写下你的评价"},domProps:{value:t.content},on:{blur:t.blurValidate,input:function(e){e.target.composing||(t.content=e.target.value)}}}),t._v(" "),o("div",{staticClass:"comment-photo border clearfix"},[t._l(t.imageArr,function(e,i){return null!=t.imageArr?o("div",{staticClass:"comment-img"},[o("default-img",{attrs:{background:t.imgUrl+e,isHeadPortrait:0,size:"0.8rem"}}),t._v(" "),o("i",{staticClass:"iconfont icon-guanbi",on:{click:function(e){t.removeImages(i)}}})],1):t._e()}),t._v(" "),null!=t.imageArr&&t.imageArr.length<3?o("div",{staticClass:"comment-upload"},[o("img-upload",{attrs:{imgURL:t.imageArr},on:{returnUrl:t.returnUrl}})],1):t._e()],2),t._v(" "),o("div",{staticClass:"comment-main-footer"},[o("div",{staticClass:"comment-button fs46 ",class:{selected:1==t.feel},on:{click:function(e){t.comment_selected(1)}}},[o("i",{staticClass:"iconfont icon-daipingjia"}),t._v(" "),o("i",{staticClass:"iconfont icon-haoping "}),t._v("\r\n                    好评\r\n                ")]),t._v(" "),o("div",{staticClass:"comment-button fs46",class:{selected:0==t.feel},on:{click:function(e){t.comment_selected(0)}}},[o("i",{staticClass:"iconfont icon-zhongping"}),t._v(" "),o("i",{staticClass:"iconfont icon-zhongping1 "}),t._v("\r\n                    中评\r\n                ")]),t._v(" "),o("div",{staticClass:"comment-button fs46  ",class:{selected:-1==t.feel},on:{click:function(e){t.comment_selected(-1)}}},[o("i",{staticClass:"iconfont icon-chaping"}),t._v(" "),o("i",{staticClass:"iconfont icon-chaping1"}),t._v("\r\n                    差评\r\n                ")])])])]),t._v(" "),o("section",{staticClass:"shop-footer-fixed comment-footer1"},[o("div",{staticClass:"shop-max-button fs52 shop-bg",on:{click:t.submitComment}},[t._v("\r\n            发表评价\r\n        ")])])])},r=[],s={render:m,staticRenderFns:r},c=s,d=o("X4nt"),l=i,u=d(n,c,!1,l,"data-v-55e6ee8f",null);e.default=u.exports},cpGb:function(t,e,o){var i=o("0Kd3");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o("5ten")("35c8f7fa",i,!0,{})},fjss:function(t,e,o){e=t.exports=o("I71c")(!1),e.push([t.i,".ik-box[data-v-da54f822]{display:-webkit-box;display:-moz-box;display:-o-box;display:box}.box-sizing[data-v-da54f822]{box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}.text-overflow[data-v-da54f822]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.upload-main-div[data-v-da54f822]{width:100%;height:100%}.upload-main-div .img-upload[data-v-da54f822]{position:relative;width:100%;height:100%;background-size:cover;background-position:50%;color:#999;border:2px dashed #999;border-radius:5px;text-align:center;display:-webkit-box;display:-moz-box;display:-o-box;display:box;-webkit-box-align:center;-o-box-align:center;box-align:center;-webkit-box-pack:center;-o-box-pack:center;box-pack:center;-webkit-box-orient:vertical;-o-box-orient:vertical;box-orient:vertical}.upload-main-div .img-upload i[data-v-da54f822]{font-size:.58666667rem}.upload-main-div .img-upload p[data-v-da54f822]{width:75%}.upload-main-div input[data-v-da54f822]{position:absolute;width:100%;height:100%;display:block;top:0;left:0;opacity:0}.upload-main-div .update-div[data-v-da54f822]{position:relative}",""])},"l4l+":function(t,e,o){"use strict";function i(t){o("rS35")}var a=o("BMa3"),n=o.n(a),m={props:["maxNums","imgURL","styles","index"],data:function(){return{imgData:[],maxNum:3,styleType:1}},mounted:function(){this.maxNums>0&&(this.maxNum=this.maxNums),this.imgData=this.imgURL,null!=this.styles&&(this.styleType=this.styles)},methods:{imageValidate:function(){if(null!=this.imgData&&this.imgData.length>=this.maxNum)return this.$store.commit("error_msg","图片最多上传"+this.maxNum+"张"),!1},readFile:function(t){var e=this,o=(t.srcElement||t.target).files,i=this;if(null!=this.imgData&&i.imgData.length+o.length>i.maxNum)return void i.$store.commit("error_msg","图片最多上传"+this.maxNum+"张");this.$store.commit("is_show_loading",!0);var a=new FormData;if(a.append("busId",i.$store.state.busId),null!=o&&o.length>0)for(var m=0;m<o.length;m++)a.append("file",o[m]);a.append("file",o);var r={headers:{"Content-Type":"multipart/form-data"}},s=window.h5App.api+h5App.activeAPI.upload_image_post;n.a.post(s,a,r).then(function(t){e.$store.commit("is_show_loading",!1);var o=t.data;if(1001==o.code)return void(location.href=o.url);if(0!=o.code)return void i.$store.commit("error_msg",o.msg);var a=o.data;i.imgData=a.split(",");var n=[i.imgData];null!=i.index&&(n[n.length]=i.index),i.$emit("returnUrl",n)})}}},r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"upload-main-div"},[1==t.styleType?o("div",{staticClass:"img-upload"},[o("i",{staticClass:"iconfont icon-xiangji"}),t._v(" "),o("p",{staticClass:"fs36"},[t._v("\n              上传凭证(最多"+t._s(t.maxNum)+"张)\n      ")]),t._v(" "),o("input",{attrs:{type:"file",accept:"image/*"},on:{change:function(e){t.readFile(e)},click:t.imageValidate}})]):t._e(),t._v(" "),2==t.styleType?o("div",{staticClass:"update-div iconfont icon-jiaimg"},[o("input",{attrs:{type:"file",accept:"image/*"},on:{change:function(e){t.readFile(e)},click:t.imageValidate}})]):t._e()])},s=[],c={render:r,staticRenderFns:s},d=c,l=o("X4nt"),u=i,p=l(m,d,!1,u,"data-v-da54f822",null);e.a=p.exports},rS35:function(t,e,o){var i=o("fjss");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o("5ten")("3e5514cf",i,!0,{})}});